(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["table"],{"2e7a":function(e,t,a){},"315e":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 故障登记\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-add mr10",attrs:{type:"primary",icon:"el-icon-lx-tag"},on:{click:e.open1}},[e._v("新增记录")]),a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"故障种类"},model:{value:e.query.type,callback:function(t){e.$set(e.query,"type",t)},expression:"query.type"}},[a("el-option",{key:"%",attrs:{label:"所有类别",value:"%"}}),a("el-option",{key:"1",attrs:{label:"投影仪",value:"1"}}),a("el-option",{key:"2",attrs:{label:"网络",value:"2"}}),a("el-option",{key:"3",attrs:{label:"云桌面",value:"3"}}),a("el-option",{key:"4",attrs:{label:"功放或音箱",value:"4"}}),a("el-option",{key:"5",attrs:{label:"电脑",value:"5"}}),a("el-option",{key:"6",attrs:{label:"幕布",value:"6"}}),a("el-option",{key:"7",attrs:{label:"扩音器或麦克风",value:"7"}}),a("el-option",{key:"8",attrs:{label:"其他",value:"8"}})],1),a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"状态"},model:{value:e.query.state,callback:function(t){e.$set(e.query,"state",t)},expression:"query.state"}},[a("el-option",{key:"%",attrs:{label:"所有状态",value:"%"}}),a("el-option",{key:"1",attrs:{label:"待处理",value:"1"}}),a("el-option",{key:"2",attrs:{label:"跟进",value:"2"}}),a("el-option",{key:"3",attrs:{label:"已处理",value:"3"}})],1),a("el-date-picker",{staticClass:"handle-select mr10",attrs:{type:"date",placeholder:"选择起始日期","value-format":"yyyy-MM-dd"},model:{value:e.query.date1,callback:function(t){e.$set(e.query,"date1",t)},expression:"query.date1"}}),a("el-date-picker",{staticClass:"handle-select mr10",attrs:{type:"date",placeholder:"选择结束日期","value-format":"yyyy-MM-dd"},model:{value:e.query.date2,callback:function(t){e.$set(e.query,"date2",t)},expression:"query.date2"}}),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"教室"},model:{value:e.query.class1,callback:function(t){e.$set(e.query,"class1",t)},expression:"query.class1"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")]),a("el-button",{attrs:{type:"warning"},on:{click:e.handleWeek}},[e._v("周四检修")]),a("el-button",{on:{click:e.handleDownload}},[e._v("下载")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header",id:"out-table"}},[a("el-table-column",{attrs:{width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"date",label:"登记日期",align:"center"}}),a("el-table-column",{attrs:{prop:"classtype",align:"center",label:"节次"}}),a("el-table-column",{attrs:{prop:"room",align:"center",label:"教室"}}),a("el-table-column",{attrs:{prop:"type",label:"故障种类",align:"center"}}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"登记人员"}}),a("el-table-column",{attrs:{prop:"state",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},["跟进"===t.row.state?a("el-tag",{attrs:{size:"medium"}},[e._v(" 跟  进 ")]):e._e(),"待处理"===t.row.state?a("el-tag",{attrs:{size:"medium",type:"danger"}},[e._v(e._s(t.row.state))]):e._e(),"已处理"===t.row.state?a("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(t.row.state))]):e._e()],1)]}}])}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.handleEdit(t.row)}}},[e._v("查看")]),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}])})],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageindex,"page-size":e.query.pagesize,total:e.pagetotal},on:{"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:e.editVisible,width:"30%"},on:{"update:visible":function(t){e.editVisible=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-divider"),a("el-form-item",{attrs:{label:"登记日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),a("el-form-item",{attrs:{label:"节次"}},[a("el-select",{attrs:{placeholder:"节次",value:"1"},model:{value:e.form.classtype,callback:function(t){e.$set(e.form,"classtype",t)},expression:"form.classtype"}},[a("el-option",{key:"1",attrs:{label:"上午 1-2节",value:"1"}}),a("el-option",{key:"2",attrs:{label:"上午 3-4节",value:"2"}}),a("el-option",{key:"3",attrs:{label:"下午 5-7节",value:"3"}}),a("el-option",{key:"4",attrs:{label:"晚上9-10节",value:"4"}})],1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"状态",value:"1"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("el-option",{key:"1",attrs:{label:"待处理",value:"1"}}),a("el-option",{key:"2",attrs:{label:"跟进",value:"2"}}),a("el-option",{key:"3",attrs:{label:"已处理",value:"3"}})],1)],1),a("el-form-item",{attrs:{label:"故障种类"}},[a("el-select",{attrs:{placeholder:"故障种类",value:"1"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{key:"1",attrs:{label:"投影仪",value:"1"}}),a("el-option",{key:"2",attrs:{label:"网络",value:"2"}}),a("el-option",{key:"3",attrs:{label:"云桌面",value:"3"}}),a("el-option",{key:"4",attrs:{label:"功放或音箱",value:"4"}}),a("el-option",{key:"5",attrs:{label:"电脑",value:"5"}}),a("el-option",{key:"6",attrs:{label:"幕布",value:"6"}}),a("el-option",{key:"7",attrs:{label:"扩音器或麦克风",value:"7"}}),a("el-option",{key:"8",attrs:{label:"其他",value:"8"}})],1)],1),a("el-form-item",{attrs:{label:"教室"}},[a("el-input",{model:{value:e.form.room,callback:function(t){e.$set(e.form,"room",t)},expression:"form.room"}})],1),a("el-form-item",{attrs:{label:"登记人员"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"故障现象"}},[a("el-input",{model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1)],1)},l=[],r=(a("7f7f"),a("6b54"),a("f576"),a("1146")),o=a.n(r),i=a("21a6"),n=a.n(i),c={name:"basetable",data:function(){return{query:{type:"%",state:"%",date1:"",date2:"",class1:"",pageindex:1,pagesize:20,pagetotal:""},tableData:[],tableData2:[],multipleSelection:[],delList:[],editVisible:!1,pagetotal:0,form:{id:0,date:"",classtype:"",room:"",type:"",reason:"",name:"",state:""},idx:-1,id:-1,loading:!0}},watch:{$route:{handler:function(e,t){var a=this;"/repair"===e.path&&a.getData()},deep:!0}},created:function(){this.getData()},methods:{getNowTime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),s=e.getDate(),l=e.getHours();a+=1,a=a.toString().padStart(2,"0"),s=s.toString().padStart(2,"0");var r="".concat(t,"-").concat(a,"-").concat(s);this.$set(this.form,"date",r),l>0&&l<=9&&this.$set(this.form,"classtype","上午 1-2节"),l>9&&l<=12&&this.$set(this.form,"classtype","上午 3-4节"),l>12&&l<=17&&this.$set(this.form,"classtype","下午 5-7节"),l>17&&l<=24&&this.$set(this.form,"classtype","晚上9-10节")},open1:function(){this.getNowTime(),this.$set(this.form,"id","0"),this.$set(this.form,"room",""),this.$set(this.form,"type",""),this.$set(this.form,"reason",""),this.$set(this.form,"name",""),this.$set(this.form,"state","待处理"),this.editVisible=!0},getData:function(){var e=this;this.loading=!0,this.$axios.post("/Repair",{type:this.query.type,state:this.query.state,date1:this.query.date1,date2:this.query.date2,class1:this.query.class1,pageindex:this.query.pageindex,pagesize:this.query.pagesize}).then((function(t){if(200===t.data.code){e.tableData=t.data.data;var a=parseInt(t.data.message);e.pagetotal=a,e.loading=!1}else 400===t.data.code?e.$message.error("查询失败:"+t.data.message):403===t.data.code?(e.$message.error("查询失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repair.getdata 出错详情: "+t.data.message);e.loading=!1})).catch((function(t){e.$message.error(t.message)}))},handleSearch:function(){this.$set(this.query,"pageIndex",1),this.getData()},handleDelete:function(e){var t=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){t.loading=!0,t.$axios.post("/RepairDelete",{id:e.id}).then((function(e){200===e.data.code?(t.getData(),t.$message.success("删除成功"),t.loading=!1):400===e.data.code?t.$message.error("失败:"+e.data.message):403===e.data.code?(t.$message.error("失败:"+e.data.message),t.loading=!1,t.$router.push({path:"/login"})):500===e.data.code&&alert("请截图以下信息报给维护员: 出错位置：repair.handledelete 出错详情: "+e.data.message),t.loading=!1})).catch((function(e){t.$message.error(e.message)}))})).catch((function(){}))},handleEdit:function(e){var t=this;this.loading=!0,this.$axios.post("/RepairInfoQuery",{id:e.id}).then((function(a){200===a.data.code?(t.loading=!1,t.$router.push({path:"/repairinfo",query:{form:e,table:a.data.data}})):400===a.data.code?t.$message.error("失败:"+a.data.message):403===a.data.code?(t.$message.error("失败:"+a.data.message),t.loading=!1,t.$router.push({path:"/login"})):500===a.data.code&&alert("请截图以下信息报给维护员: 出错位置：repair.handledit 出错详情: "+a.data.message),t.loading=!1})).catch((function(e){t.$message.error(e.message)}))},saveEdit:function(){var e=this;this.editVisible=!1,this.loading=!0,this.$axios.post("/RepairAdd",{id:this.form.id,date:this.form.date,classtype:this.form.classtype,room:this.form.room,type:this.form.type,reason:this.form.reason,name:this.form.name,state:this.form.state}).then((function(t){200===t.data.code?(e.getData(),e.$message.success("成功")):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repair.saveEdit 出错详情: "+t.data.message),e.loading=!1})).catch((function(t){e.$message.error(t.message)}))},handlePageChange:function(e){this.$set(this.query,"pageindex",e),this.getData()},handleWeek:function(){this.$router.push("/weeklyrepair")},handleDownload:function(){var e=this;this.loading=!0,this.$axios.post("/Repair",{type:this.query.type,state:this.query.state,date1:this.query.date1,date2:this.query.date2,class1:this.query.class1,pageindex:1,pagesize:this.pagetotal}).then((function(t){if(200===t.data.code){e.tableData=t.data.data;var a=parseInt(t.data.message);e.loading=!1,e.query.pagesize=a,e.query.pageindex=1;var s=e;setTimeout((function(){var e=o.a.utils.table_to_book(document.querySelector("#out-table")),t=o.a.write(e,{bookType:"xlsx",bookSST:!0,type:"array"});try{n.a.saveAs(new Blob([t],{type:"application/octet-stream"}),"导出的表格.xlsx")}catch(a){"undefined"!==typeof console&&console.log(a,t)}return s.query.pagesize=20,t}),300)}else 400===t.data.code?e.$message.error("查询失败:"+t.data.message):403===t.data.code?(e.$message.error("查询失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repair.getdata 出错详情: "+t.data.message);e.loading=!1})).catch((function(t){e.$message.error(t.message)}))}}},d=c,m=(a("e8fa"),a("2877")),u=Object(m["a"])(d,s,l,!1,null,"4220b984",null);t["default"]=u.exports},"3ed5":function(e,t,a){"use strict";var s=a("2e7a"),l=a.n(s);l.a},"796f":function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-cascades"}),e._v(" 在线签到\n            ")])],1)],1),a("div",{staticClass:"container"},[a("div",{staticClass:"handle-box"},[a("el-button",{staticClass:"handle-add mr10",attrs:{type:"primary",icon:"el-icon-lx-tag"},on:{click:e.open1}},[e._v("在线签到")]),a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"签到类型"},model:{value:e.query.type,callback:function(t){e.$set(e.query,"type",t)},expression:"query.type"}},[a("el-option",{key:"%",attrs:{label:"所有",value:"%"}}),a("el-option",{key:"1",attrs:{label:"值班",value:"1"}}),a("el-option",{key:"2",attrs:{label:"替班",value:"2"}}),a("el-option",{key:"3",attrs:{label:"加班",value:"3"}}),a("el-option",{key:"4",attrs:{label:"检修",value:"4"}})],1),a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"状态"},model:{value:e.query.state,callback:function(t){e.$set(e.query,"state",t)},expression:"query.state"}},[a("el-option",{key:"%",attrs:{label:"所有状态",value:"%"}}),a("el-option",{key:"1",attrs:{label:"待确认",value:"2"}}),a("el-option",{key:"2",attrs:{label:"已确认",value:"1"}})],1),a("el-date-picker",{staticClass:"handle-select mr10",attrs:{type:"date",placeholder:"选择起始日期","value-format":"yyyy-MM-dd"},model:{value:e.query.date1,callback:function(t){e.$set(e.query,"date1",t)},expression:"query.date1"}}),a("el-date-picker",{staticClass:"handle-select mr10",attrs:{type:"date",placeholder:"选择结束日期","value-format":"yyyy-MM-dd"},model:{value:e.query.date2,callback:function(t){e.$set(e.query,"date2",t)},expression:"query.date2"}}),a("el-input",{staticClass:"handle-input mr10",attrs:{placeholder:"签到人员"},model:{value:e.query.name,callback:function(t){e.$set(e.query,"name",t)},expression:"query.name"}}),a("el-button",{attrs:{type:"primary",icon:"el-icon-search"},on:{click:e.handleSearch}},[e._v("搜索")])],1),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"start",label:"上班时间",align:"center",width:"200"}}),a("el-table-column",{attrs:{prop:"length",align:"center",label:"时长"}}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"登记人员"}}),a("el-table-column",{attrs:{prop:"type",label:"签到类型",align:"center"}}),a("el-table-column",{attrs:{prop:"salary",align:"center",label:"工资"}}),a("el-table-column",{attrs:{prop:"state",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},["待确认"===t.row.state?a("el-tag",{attrs:{size:"medium",type:"danger"}},[e._v(e._s(t.row.state))]):e._e(),"已确认"===t.row.state?a("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(t.row.state))]):e._e()],1)]}}])}),"主管"===e.usertype||"主管老师"===e.usertype?a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",icon:"el-icon-edit"},on:{click:function(a){return e.open2(t.row)}}},[e._v("查看")]),a("el-button",{staticClass:"red",attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete(t.row)}}},[e._v("删除")])]}}],null,!1,4009896125)}):e._e()],1),a("div",{staticClass:"pagination"},[a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next","current-page":e.query.pageindex,"page-size":e.query.pagesize,total:e.pagetotal},on:{"current-change":e.handlePageChange}})],1)],1),a("el-dialog",{attrs:{title:"新增在线签到",visible:e.editVisible3,width:"30%"},on:{"update:visible":function(t){e.editVisible3=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-divider"),a("el-form-item",{attrs:{label:"上班时间"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"选择上班时间"},model:{value:e.form.start,callback:function(t){e.$set(e.form,"start",t)},expression:"form.start"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"签到类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{key:"%",attrs:{label:"所有",value:"%"}}),a("el-option",{key:"1",attrs:{label:"值班",value:"1"}}),a("el-option",{key:"2",attrs:{label:"替班",value:"2"}}),a("el-option",{key:"3",attrs:{label:"加班",value:"3"}}),a("el-option",{key:"4",attrs:{label:"检修",value:"4"}})],1)],1),a("el-form-item",{attrs:{label:"工作时长"}},[a("el-input",{model:{value:e.form.length,callback:function(t){e.$set(e.form,"length",t)},expression:"form.length"}})],1),a("el-form-item",{attrs:{label:"签到人员"}},[a("el-input",{attrs:{disabled:e.show2},model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"如果不是值班请填写备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible3=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"查看或编辑",visible:e.editVisible4,width:"30%"},on:{"update:visible":function(t){e.editVisible4=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-divider"),a("el-form-item",{attrs:{label:"上班时间"}},[a("el-time-picker",{attrs:{"value-format":"HH:mm:ss",placeholder:"选择上班时间"},model:{value:e.form.start,callback:function(t){e.$set(e.form,"start",t)},expression:"form.start"}})],1),a("el-form-item",{attrs:{label:"类型"}},[a("el-select",{attrs:{placeholder:"签到类型"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{key:"1",attrs:{label:"值班",value:"1"}}),a("el-option",{key:"2",attrs:{label:"替班",value:"2"}}),a("el-option",{key:"3",attrs:{label:"加班",value:"3"}}),a("el-option",{key:"4",attrs:{label:"检修",value:"4"}})],1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{staticClass:"handle-select mr10",attrs:{placeholder:"状态"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("el-option",{key:"1",attrs:{label:"待确认",value:"待确认"}}),a("el-option",{key:"2",attrs:{label:"已确认",value:"已确认"}})],1)],1),a("el-form-item",{attrs:{label:"工作时长"}},[a("el-input",{model:{value:e.form.length,callback:function(t){e.$set(e.form,"length",t)},expression:"form.length"}})],1),a("el-form-item",{attrs:{label:"签到人员"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{attrs:{placeholder:"如果不是值班请填写备注"},model:{value:e.form.remark,callback:function(t){e.$set(e.form,"remark",t)},expression:"form.remark"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible4=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit2}},[e._v("确 定")])],1)],1)],1)},l=[],r=(a("6b54"),a("f576"),a("7f7f"),{name:"Sign",data:function(){return{form:{id:"",start:"",type:"",length:"",name:"",remark:"",state:""},tableData:[],query:{type:"%",state:"%",date1:"",date2:"",name:"",length:"",pageindex:1,pagesize:20},editVisible3:!1,editVisible4:!1,pagetotal:0,loading:!0,usertype:""}},created:function(){this.getData()},computed:{show2:function(){var e=localStorage.getItem("type");return"主管"!==e&&"主管老师"!==e&&"组长"!==e}},watch:{$route:{handler:function(e,t){var a=this;"/sign"===e.path&&a.getData()},deep:!0}},methods:{getData:function(){var e=this;this.loading=!0,this.$axios.post("/Sign",{type:this.query.type,state:this.query.state,date1:this.query.date1,date2:this.query.date2,name:this.query.name,length:this.query.length,pageindex:this.query.pageindex,pagesize:this.query.pagesize}).then((function(t){if(e.usertype=localStorage.getItem("type"),200===t.data.code){e.tableData=t.data.data;var a=parseInt(t.data.message);e.pagetotal=a,e.loading=!1}else 400===t.data.code?e.$message.error("查询失败:"+t.data.message):403===t.data.code?(e.$message.error("查询失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：sign.getData 出错详情: "+t.data.message);e.loading=!1})).catch((function(t){e.$message.error(t.message)}))},handlePageChange:function(e){this.$set(this.query,"pageindex",e),this.getData()},getNowTime:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),s=e.getDate(),l=e.getHours();a+=1,a=a.toString().padStart(2,"0"),s=s.toString().padStart(2,"0");"".concat(t,"-").concat(a,"-").concat(s);l>=0&&l<=9&&(this.$set(this.form,"start","08:10:00"),this.$set(this.form,"length","2")),l>9&&l<=12&&(this.$set(this.form,"start","10:10:00"),this.$set(this.form,"length","2")),l>12&&l<=17&&(this.$set(this.form,"start","14:10:00"),this.$set(this.form,"length","3")),l>17&&l<24&&(this.$set(this.form,"start","19:10:00"),this.$set(this.form,"length","2"))},handleSearch:function(){this.$set(this.query,"pageindex",1),this.getData()},open2:function(e){this.form.start=e.start,this.form.type=e.type,this.form.name=e.name,this.form.remark=e.remark,this.form.length=e.length,this.form.state=e.state,this.form.id=e.id,"null"==e.remark&&(this.form.remark=null),this.editVisible4=!0},open1:function(){this.getNowTime();var e=localStorage.getItem("name");this.$set(this.form,"type","值班"),this.$set(this.form,"name",e),this.$set(this.form,"remark",""),this.editVisible3=!0},saveEdit:function(){var e=this,t=new Date,a=t.getFullYear(),s=t.getMonth(),l=t.getDate();s+=1,s=s.toString().padStart(2,"0"),l=l.toString().padStart(2,"0");var r="".concat(a,"-").concat(s,"-").concat(l);this.editVisible3=!1,this.loading=!0,this.$axios.post("/SignAdd",{start:r+" "+this.form.start,length:this.form.length,name:this.form.name,type:this.form.type,remark:this.form.remark}).then((function(t){200===t.data.code?(e.getData(),e.$message.success("成功")):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：sign.saveEdit 出错详情: "+t.data.message),e.loading=!1,e.getData()})).catch((function(t){e.$message.error(t.message)}))},saveEdit2:function(){var e=this,t=new Date,a=t.getFullYear(),s=t.getMonth(),l=t.getDate();s+=1,s=s.toString().padStart(2,"0"),l=l.toString().padStart(2,"0");"".concat(a,"-").concat(s,"-").concat(l);this.editVisible4=!1,this.loading=!0,this.$axios.post("/SignUpdate",{id:this.form.id,start:this.form.start,length:this.form.length,name:this.form.name,type:this.form.type,remark:this.form.remark,state:this.form.state}).then((function(t){200===t.data.code?(e.getData(),e.$message.success("成功")):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：monney.getdata 出错详情: "+t.data.message),e.getData(),e.loading=!1})).catch((function(t){e.$message.error(t.message)}))},handleDelete:function(e){var t=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){t.loading=!0,t.$axios.post("/SignDelete",{id:e.id}).then((function(e){200===e.data.code?(t.getData(),t.$message.success("删除成功"),t.loading=!1):400===e.data.code?t.$message.error("失败:"+e.data.message):403===e.data.code?(t.$message.error("失败:"+e.data.message),t.loading=!1,t.$router.push({path:"/login"})):500===e.data.code&&alert("请截图以下信息报给维护员: 出错位置：sign.handleDelete 出错详情: "+e.data.message),t.loading=!1})).catch((function(e){t.$message.error(e.message)}))})).catch((function(){}))}}}),o=r,i=(a("3ed5"),a("2877")),n=Object(i["a"])(o,s,l,!1,null,"141b671b",null);t["default"]=n.exports},"7ef8":function(e,t,a){},af4b:function(e,t,a){"use strict";a.r(t);var s=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("div",{staticClass:"crumbs"},[a("el-breadcrumb",{attrs:{separator:"/"}},[a("el-breadcrumb-item",[a("i",{staticClass:"el-icon-lx-calendar"}),e._v(" 故障详情\n            ")]),a("el-breadcrumb-item",[e._v("故障详情")])],1)],1),a("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"hover"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData,"header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"date",label:"登记日期",align:"center"}}),a("el-table-column",{attrs:{prop:"classtype",align:"center",label:"节次"}}),a("el-table-column",{attrs:{prop:"room",align:"center",label:"教室"}}),a("el-table-column",{attrs:{prop:"type",label:"故障种类",align:"center"}}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"登记人员"}}),a("el-table-column",{attrs:{prop:"state",label:"状态",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("div",{staticClass:"name-wrapper",attrs:{slot:"reference"},slot:"reference"},["跟进"===t.row.state?a("el-tag",{attrs:{size:"medium"}},[e._v(" 跟  进 ")]):e._e(),"待处理"===t.row.state?a("el-tag",{attrs:{size:"medium",type:"danger"}},[e._v(e._s(t.row.state))]):e._e(),"已处理"===t.row.state?a("el-tag",{attrs:{size:"medium",type:"success"}},[e._v(e._s(t.row.state))]):e._e()],1)]}}])})],1)],1),a("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("故障现象")])]),a("el-tooltip",{staticClass:"item",attrs:{effect:"dark",content:"在此修改并不会录入数据库，如需编辑请点击下方编辑按钮",placement:"bottom-start"}},[a("el-input",{attrs:{placeholder:"加载中"},model:{value:e.input2,callback:function(t){e.input2=t},expression:"input2"}})],1)],1),a("el-card",{staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"hover"}},[a("div",{staticClass:"clearfix",attrs:{slot:"header"},slot:"header"},[a("span",[e._v("处理信息")])]),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.loading,expression:"loading"}],staticClass:"table",staticStyle:{width:"100%"},attrs:{data:e.tableData2,"header-cell-class-name":"table-header"}},[a("el-table-column",{attrs:{width:"55",align:"center"}}),a("el-table-column",{attrs:{prop:"date",label:"处理时间",align:"center"}}),a("el-table-column",{attrs:{prop:"deal",align:"center",label:"维修过程"}}),a("el-table-column",{attrs:{prop:"name",align:"center",label:"维修人员"}}),a("el-table-column",{attrs:{prop:"remarks",label:"备注",align:"center"}}),a("el-table-column",{attrs:{label:"操作",width:"180",align:"center"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{staticStyle:{color:"#ff0000"},attrs:{type:"text",icon:"el-icon-delete"},on:{click:function(a){return e.handleDelete2(t.row)}}},[e._v("删除")])]}}])})],1)],1),a("el-row",{staticClass:"row-bg",attrs:{type:"flex",justify:"space-around"}},[a("el-col",{attrs:{span:3}},[a("el-button",{staticStyle:{width:"100%",height:"40px"},attrs:{type:"primary",icon:"el-icon-message"},on:{click:e.open2}},[e._v("添加维修记录")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{staticStyle:{width:"100%",height:"40px"},attrs:{type:"warning",icon:"el-icon-edit"},on:{click:e.open1}},[e._v("编辑这条记录")])],1),a("el-col",{attrs:{span:3}},[a("el-button",{staticStyle:{width:"100%",height:"40px"},attrs:{type:"danger",icon:"el-icon-delete"},on:{click:e.handleDelete}},[e._v("删除这条记录")])],1)],1),a("el-dialog",{attrs:{title:"编辑",visible:e.editVisible2,width:"30%"},on:{"update:visible":function(t){e.editVisible2=t}}},[a("el-form",{ref:"form",attrs:{model:e.form,"label-width":"70px"}},[a("el-divider"),a("el-form-item",{attrs:{label:"登记日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form.date,callback:function(t){e.$set(e.form,"date",t)},expression:"form.date"}})],1),a("el-form-item",{attrs:{label:"节次"}},[a("el-select",{attrs:{placeholder:"节次",value:"1"},model:{value:e.form.classtype,callback:function(t){e.$set(e.form,"classtype",t)},expression:"form.classtype"}},[a("el-option",{key:"1",attrs:{label:"上午 1-2节",value:"上午 1-2节"}}),a("el-option",{key:"2",attrs:{label:"上午 3-4节",value:"上午 3-4节"}}),a("el-option",{key:"3",attrs:{label:"下午 5-7节",value:"下午 5-7节"}}),a("el-option",{key:"4",attrs:{label:"晚上9-10节",value:"晚上9-10节"}})],1)],1),a("el-form-item",{attrs:{label:"状态"}},[a("el-select",{attrs:{placeholder:"状态",value:"1"},model:{value:e.form.state,callback:function(t){e.$set(e.form,"state",t)},expression:"form.state"}},[a("el-option",{key:"1",attrs:{label:"待处理",value:"待处理"}}),a("el-option",{key:"2",attrs:{label:"跟进",value:"跟进"}}),a("el-option",{key:"3",attrs:{label:"已处理",value:"已处理"}})],1)],1),a("el-form-item",{attrs:{label:"故障种类"}},[a("el-select",{attrs:{placeholder:"故障种类",value:"1"},model:{value:e.form.type,callback:function(t){e.$set(e.form,"type",t)},expression:"form.type"}},[a("el-option",{key:"1",attrs:{label:"投影仪",value:"投影仪"}}),a("el-option",{key:"2",attrs:{label:"网络",value:"网络"}}),a("el-option",{key:"3",attrs:{label:"云桌面",value:"云桌面"}}),a("el-option",{key:"4",attrs:{label:"功放或音箱",value:"功放或音箱"}}),a("el-option",{key:"5",attrs:{label:"电脑",value:"电脑"}}),a("el-option",{key:"6",attrs:{label:"幕布",value:"幕布"}}),a("el-option",{key:"7",attrs:{label:"扩音器或麦克风",value:"扩音器或麦克风"}}),a("el-option",{key:"8",attrs:{label:"其他",value:"其他"}})],1)],1),a("el-form-item",{attrs:{label:"教室"}},[a("el-input",{model:{value:e.form.room,callback:function(t){e.$set(e.form,"room",t)},expression:"form.room"}})],1),a("el-form-item",{attrs:{label:"登记人员"}},[a("el-input",{model:{value:e.form.name,callback:function(t){e.$set(e.form,"name",t)},expression:"form.name"}})],1),a("el-form-item",{attrs:{label:"故障现象"}},[a("el-input",{model:{value:e.form.reason,callback:function(t){e.$set(e.form,"reason",t)},expression:"form.reason"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible2=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit}},[e._v("确 定")])],1)],1),a("el-dialog",{attrs:{title:"新增维修信息",visible:e.editVisible3,width:"30%"},on:{"update:visible":function(t){e.editVisible3=t}}},[a("el-form",{ref:"form",attrs:{model:e.form2,"label-width":"70px"}},[a("el-divider"),a("el-form-item",{attrs:{label:"处理日期"}},[a("el-date-picker",{attrs:{type:"date",placeholder:"选择日期","value-format":"yyyy-MM-dd"},model:{value:e.form2.date,callback:function(t){e.$set(e.form2,"date",t)},expression:"form2.date"}})],1),a("el-form-item",{attrs:{label:"处理状态"}},[a("el-select",{attrs:{placeholder:"状态",value:"已处理"},model:{value:e.form2.state,callback:function(t){e.$set(e.form2,"state",t)},expression:"form2.state"}},[a("el-option",{key:"1",attrs:{label:"待处理",value:"待处理"}}),a("el-option",{key:"2",attrs:{label:"跟进",value:"跟进"}}),a("el-option",{key:"3",attrs:{label:"已处理",value:"已处理"}})],1)],1),a("el-form-item",{attrs:{label:"处理人员"}},[a("el-input",{model:{value:e.form2.name,callback:function(t){e.$set(e.form2,"name",t)},expression:"form2.name"}})],1),a("el-form-item",{attrs:{label:"维修过程"}},[a("el-input",{model:{value:e.form2.deal,callback:function(t){e.$set(e.form2,"deal",t)},expression:"form2.deal"}})],1),a("el-form-item",{attrs:{label:"备注"}},[a("el-input",{model:{value:e.form2.remarks,callback:function(t){e.$set(e.form2,"remarks",t)},expression:"form2.remarks"}})],1)],1),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.editVisible3=!1}}},[e._v("取 消")]),a("el-button",{attrs:{type:"primary"},on:{click:e.saveEdit2}},[e._v("确 定")])],1)],1)],1)},l=[],r=(a("7f7f"),a("6b54"),a("f576"),{name:"baseform",data:function(){return{form:{id:0,date:"",classtype:"",room:"",type:"",reason:"",name:"",state:""},form2:{id:"",repair:"",date:"",deal:"",remarks:"",name:"",state:"已处理"},tableData:[],tableData2:[],editVisible2:!1,editVisible3:!1,input2:"",loading:!0}},watch:{$route:{handler:function(e,t){var a=this;"/repairinfo"===e.path&&a.getData()},deep:!0}},created:function(){this.getData()},methods:{onSubmit:function(){this.$message.success("提交成功！")},open1:function(){this.editVisible2=!0},open2:function(){var e=new Date,t=e.getFullYear(),a=e.getMonth(),s=e.getDate();e.getHours();a+=1,a=a.toString().padStart(2,"0"),s=s.toString().padStart(2,"0");var l="".concat(t,"-").concat(a,"-").concat(s);this.$set(this.form2,"date",l),this.editVisible3=!0},saveEdit:function(){var e=this;this.editVisible2=!1,this.loading=!0,this.$axios.post("/RepairAdd",{id:this.form.id,date:this.form.date,classtype:this.form.classtype,room:this.form.room,type:this.form.type,reason:this.form.reason,name:this.form.name,state:this.form.state}).then((function(t){200===t.data.code?(e.tableData=[e.form],e.$message.success("添加或编辑成功")):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repairinfo.saveEdit 出错详情: "+t.data.message),e.loading=!1})).catch((function(t){e.$message.error(t.message)}))},saveEdit2:function(){var e=this;this.editVisible3=!1,this.loading=!0,this.$axios.post("/RepairInfoAdd",{repair:this.form2.repair,date:this.form2.date,deal:this.form2.deal,remarks:this.form2.remarks,name:this.form2.name,state:this.form2.state}).then((function(t){200===t.data.code?(e.$axios.post("/RepairInfoQuery",{id:e.form.id}).then((function(t){200===t.data.code?(e.loading=!1,e.tableData2=t.data.data):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repairinfo.saveEdit2.res1 出错详情: "+t.data.message),e.loading=!1})).catch((function(t){e.$message.error(t.message)})),e.$axios.post("/RepairQueryByID",{id:e.form.id}).then((function(t){200===t.data.code?(e.loading=!1,e.tableData=[t.data.data]):400===res1.data.code?e.$message.error("查询失败:"+t.data.message):403===res1.data.code?(e.$message.error("查询失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repairinfo.saveEdit2.res7 出错详情: "+t.data.message),e.loading=!1})).catch((function(t){e.$message.error(t.message)})),e.$message.success("添加处理信息成功")):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repairinfo.saveEdit2.res4 出错详情: "+t.data.message),e.loading=!1})).catch((function(t){e.$message.error(t.message)}))},goBack:function(){this.$router.go(-1)},getData:function(){this.form.id=this.$route.query.form.id,this.form.date=this.$route.query.form.date,this.form.classtype=this.$route.query.form.classtype,this.form.room=this.$route.query.form.room,this.form.type=this.$route.query.form.type,this.form.reason=this.$route.query.form.reason,this.form.name=this.$route.query.form.name,this.form.state=this.$route.query.form.state,this.tableData=[this.$route.query.form],this.tableData2=this.$route.query.table,this.input2=this.form.reason,this.form2.repair=this.form.id,this.loading=!1},handleDelete2:function(e){var t=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){t.loading=!0,t.$axios.post("/RepairInfoDelete",{id:e.id}).then((function(e){200===e.data.code?(t.$axios.post("/RepairInfoQuery",{id:t.form.id}).then((function(e){200===e.data.code?(t.loading=!1,t.tableData2=e.data.data):400===e.data.code?t.$message.error("失败:"+e.data.message):403===e.data.code?(t.$message.error("失败:"+e.data.message),t.loading=!1,t.$router.push({path:"/login"})):500===e.data.code&&alert("请截图以下信息报给维护员: 出错位置：repairinfo.handleDelete2.res1 出错详情: "+e.data.message),t.loading=!1})).catch((function(e){t.$message.error(e.message)})),t.getData(),t.$message.success("删除成功")):400===e.data.code?t.$message.error("查询失败:"+e.data.message):403===e.data.code?(t.$message.error("查询失败:"+e.data.message),t.loading=!1,t.$router.push({path:"/login"})):500===e.data.code&&alert("请截图以下信息报给维护员: 出错位置：monney.getdata 出错详情: "+e.data.message),t.loading=!1})).catch((function(e){t.$message.error(e.message)}))})).catch((function(){}))},handleDelete:function(){var e=this;this.$confirm("确定要删除吗？","提示",{type:"warning"}).then((function(){e.loading=!0,e.$axios.post("/RepairDelete",{id:e.form.id}).then((function(t){200===t.data.code?(e.getData(),e.goBack(),e.$message.success("删除成功")):400===t.data.code?e.$message.error("失败:"+t.data.message):403===t.data.code?(e.$message.error("失败:"+t.data.message),e.loading=!1,e.$router.push({path:"/login"})):500===t.data.code&&alert("请截图以下信息报给维护员: 出错位置：repairinfo.handleDelete 出错详情: "+t.data.message),e.loading=!1})).catch((function(t){e.$message.error(t.message)}))})).catch((function(){}))}}}),o=r,i=a("2877"),n=Object(i["a"])(o,s,l,!1,null,null,null);t["default"]=n.exports},e8fa:function(e,t,a){"use strict";var s=a("7ef8"),l=a.n(s);l.a}}]);